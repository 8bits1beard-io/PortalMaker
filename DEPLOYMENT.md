# Enterprise Deployment Guide

This guide covers deploying Landing Page Studio-generated pages to Windows devices using enterprise management tools.

## PowerShell Script Deployment

The generated PowerShell script (`Generate-LandingPage_[ScriptName].ps1`) handles:

- Creating the destination folder
- Writing the HTML file
- Logging all operations

### Script Parameters

| Parameter | Description |
|-----------|-------------|
| `-Uninstall` | Remove the landing page |

### Intune Deployment

1. **Download** the PowerShell script from Landing Page Studio
2. In **Intune Admin Center**, go to **Devices > Scripts**
3. Click **Add > Windows 10 and later**
4. Upload the `.ps1` file
5. Configure:
   - Run this script using the logged on credentials: **No**
   - Enforce script signature check: **No**
   - Run script in 64 bit PowerShell Host: **Yes**
6. Assign to device groups

### Intune Win32 App Deployment

For more control (detection rules, dependencies, uninstall):

1. **Package** the script using the [Microsoft Win32 Content Prep Tool](https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool):
   ```cmd
   IntuneWinAppUtil.exe -c <source_folder> -s Generate-LandingPage_MyScript.ps1 -o <output_folder>
   ```

2. In **Intune Admin Center**, go to **Apps > Windows**
3. Click **Add** and select **Windows app (Win32)**
4. Upload the `.intunewin` file
5. Configure:
   - **Install command**: `powershell.exe -ExecutionPolicy Bypass -File Generate-LandingPage_MyScript.ps1`
   - **Uninstall command**: `powershell.exe -ExecutionPolicy Bypass -File Generate-LandingPage_MyScript.ps1 -Uninstall`
   - **Detection rule**: File exists at destination path (e.g., `C:\ProgramData\LandingPage\index.html`)

### SCCM/ConfigMgr Deployment

1. Create a **Package** with the PowerShell script as source
2. Create a **Program** with command line:
   ```
   powershell.exe -ExecutionPolicy Bypass -File Generate-LandingPage_MyScript.ps1
   ```
3. Deploy to target collection

## Kiosk Browser Configuration

### Microsoft Edge Kiosk Mode

Set Edge to open the landing page in kiosk mode:

```
msedge.exe --kiosk "C:\ProgramData\LandingPage\index.html" --edge-kiosk-type=fullscreen
```

For public browsing mode (with navigation):
```
msedge.exe --kiosk "C:\ProgramData\LandingPage\index.html" --edge-kiosk-type=public-browsing
```

### Windows Assigned Access (Single-App Kiosk)

1. Open **Settings > Accounts > Other users**
2. Click **Set up a kiosk**
3. Select **Microsoft Edge** as the kiosk app
4. Set the landing page URL as the default page

### Multi-App Kiosk (Windows Configuration Designer)

Create a provisioning package with:
- Allowed apps including Edge
- Start layout with Edge tile pointing to the landing page
- Shell launcher configuration

## File Locations

| Path | Purpose |
|------|---------|
| `C:\ProgramData\LandingPage\` | Default installation folder |
| `C:\ProgramData\LandingPage\index.html` | Landing page HTML |
| `C:\ProgramData\LandingPage\Logs\` | Installation logs |

## Troubleshooting

### Computer name shows as placeholder
- The HTML file must be generated by the PowerShell script on the target machine
- Direct HTML downloads show `%COMPUTERNAME%` placeholder

### Page doesn't load in kiosk mode
- Verify the HTML file exists at the configured path
- Check Edge kiosk policies allow local file access
- Review Windows Event Viewer for errors
